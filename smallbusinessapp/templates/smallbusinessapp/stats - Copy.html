<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>Search Page</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css">

    <style>
        
        html {
            font-family: sans-serif;
        }
  
        body{
            width:70%;
            max-width: 1800px;
            min-width: 480px;
            margin: 0 auto;
        }

        .resultBusinesses {
    border-collapse: collapse;
    margin: 25px 0;
    font-size: 0.9em;
    font-family: sans-serif;
    min-width: 400px;
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.15);
}

.resultBusinesses thead tr {
    background-color: #009879;
    color: #ffffff;
    text-align: left;
}

.resultBusinesses th,
.resultBusinesses td {
    padding: 12px 15px;
}

.resultBusinesses tbody tr {
    border-bottom: 1px solid #dddddd;
}

.resultBusinesses tbody tr:nth-of-type(even) {
    background-color: #f3f3f3;
}

.resultBusinesses tbody tr:last-of-type {
    border-bottom: 2px solid #009879;
}

#selectors {
    border:1px solid black;
    width: 80%;
    margin: auto;
    padding:10px;
}

h2 {align-items: center;
    width: 80%;
    margin: auto;
font-size:x-large;}

td {cursor: pointer;}

thead {cursor: pointer;}

.row {
    margin-top: 10px;
    margin-bottom: 10px;
}

.b-example-divider {
  height: 3rem;
  background-color: rgba(0, 0, 0, .1);
  border: solid rgba(0, 0, 0, .15);
  border-width: 1px 0;
  box-shadow: inset 0 .5em 1.5em rgba(0, 0, 0, .1), inset 0 .125em .5em rgba(0, 0, 0, .15);
}

.form-control-dark {
  color: #fff;
  background-color: var(--bs-dark);
  border-color: var(--bs-gray);
}
.form-control-dark:focus {
  color: #fff;
  background-color: var(--bs-dark);
  border-color: #fff;
  box-shadow: 0 0 0 .25rem rgba(255, 255, 255, .25);
}

.bi {
  vertical-align: -.125em;
  fill: currentColor;
}

.text-small {
  font-size: 85%;
}

.dropdown-toggle {
  outline: 0;
}

    </style>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  </head>

  <body>
    <div class="container">
        <header class="d-flex flex-wrap align-items-center justify-content-center justify-content-md-between py-3 mb-4 border-bottom">
            <a href="/stats" class="d-flex align-items-center text-dark text-decoration-none">
            <button type="button" class="btn btn-secondary" style="margin:5px;">

            
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16">
                <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
              </svg>
            </button>
              <span class="fs-4"> Small Business Size Lookup</span>
            
          </a>
    
          <ul class="nav col-12 col-md-auto mb-2 justify-content-center mb-md-0">
            <li><a href="#" class="nav-link px-2 link-secondary">Lookup</a></li>
            <li><a href="pricing/" class="nav-link px-2 link-dark">Pricing</a></li>
            <li><a href="{% url 'faq' %}" class="nav-link px-2 link-dark">FAQs</a></li>
          </ul>
    
          <div class="col-md-3 text-end">
            <button type="button" class="btn btn-outline-primary me-2">Login</button>
          </div>
        </header>
      
        <h2 class="heading">Lookup key data on millions of small businesses:</h2>
      <div id="selectors" class="shadow">
          <div class="row">
            <!-- <input type="text" id="companyName" class="companyName col-md-4" placeholder="Company Name" style="grid-column:1;grid-row:1;" class="form-control">
            <input type="text" id="industry" class="industry" placeholder="Industry" style="grid-column:2;grid-row:1;" class="form-control">
            <select id="states" name="states" style="grid-column:3;grid-row:1;" class="form-select">
                <option value="Any">Any State</option>
                {% for state in my_states %}
                <option value={{state.abbreviation}}>{{state.name}}</option>
                {% endfor %}
            </select> -->
            <div class="col-md-4">
                <input type="text" id="companyName" class="companyName form-control" placeholder="Company Name">
            </div>
            <div class="col-md-4">
                <input type="text" id="industry" class="industry form-control" placeholder="Industry">
            </div>
            <div class="col-md-4">
                <select id="states" name="states" class="form-select">
                    <option value="Any">Any State</option>
                    {% for state in my_states %}
                    <option value={{state.abbreviation}}>{{state.name}}</option>
                    {% endfor %}
                </select>
            </div>

        </div>

        <div class="row">
            <div class="col-md-4">
                <select id="revenueRange" name="revenueRange"class="form-select">
                    <option value="Any">Any Revenue</option>
                    <option value="over">Over $300 Million</option>
                    <option value="200000000-300000000">$200-300 Million</option>
                    <option value="150000000-200000000">$150-200 Million</option>
                    <option value="100000000-150000000">$100-150 Million</option>
                    <option value="75000000-100000000">$75-100 Million</option>
                    <option value="50000000-75000000">$50-75 Million</option>
                    <option value="25000000-50000000">$25-50 Million</option>
                    <option value="10000000-25000000">$10-25 Million</option>
                    <option value="5000000-10000000">$5-10 Million</option>
                    <option value="2000000-5000000">$2-5 Million</option>
                    <option value="1000000-2000000">$1-2 Million</option>
                    <option value="below">Below $1 Million</option>
                </select>
            </div>
            <div class="col-md-4">
                <select id="employeeRange" name="employeeRange" class="form-select">
                    <option value="Any">Any Employee Count</option>
                    <option value="over">400+</option>
                    <option value="300-400">300-400</option>
                    <option value="200-300">200-300</option>
                    <option value="100-200">100-200</option>
                    <option value="50-100">50-100</option>
                    <option value="25-50">25-50</option>
                    <option value="10-25">10-25</option>
                    <option value="2-10">2-10</option>
                    <option value="below">1</option>
                </select>
            </div>
            <div class="col-md-4">
                <input type="text" id="zipCode" placeholder="Zip Code" class="form-control">
            </div>

        </div>
        <div class="row">
            <div class="col-md-2">
                <input type="submit" value="Search" id="searchBusinessSubmit" class="btn btn-primary">
            </div>
            <div class="col-md-2">
                <input type="reset" value="Reset" id="resetSearchParameters" class="btn btn-secondary">
            </div>
        </div>
    </div>

    <p id="numBusinesses"></p>
    <div class="d-flex justify-content-center" id="tableSpinner">
    </div>
    {% load my_filters%}

    <div class="table-responsive">
    <table id="resultBusinesses" class="table table-striped table-hover">
        <thead class="table-light">
            <th>
              Name
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-down-up" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M11.5 15a.5.5 0 0 0 .5-.5V2.707l3.146 3.147a.5.5 0 0 0 .708-.708l-4-4a.5.5 0 0 0-.708 0l-4 4a.5.5 0 1 0 .708.708L11 2.707V14.5a.5.5 0 0 0 .5.5zm-7-14a.5.5 0 0 1 .5.5v11.793l3.146-3.147a.5.5 0 0 1 .708.708l-4 4a.5.5 0 0 1-.708 0l-4-4a.5.5 0 0 1 .708-.708L4 13.293V1.5a.5.5 0 0 1 .5-.5z"/>
              </svg>
            </th>
            <th>Address</th>
            <th>State</th>
            <th style="background-color: #3f87a6;">Revenue
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-up" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M8 15a.5.5 0 0 0 .5-.5V2.707l3.146 3.147a.5.5 0 0 0 .708-.708l-4-4a.5.5 0 0 0-.708 0l-4 4a.5.5 0 1 0 .708.708L7.5 2.707V14.5a.5.5 0 0 0 .5.5z"/>
                  </svg>
            </th>
            <th>Employees</th>
            <th>Payroll
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-down-up" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M11.5 15a.5.5 0 0 0 .5-.5V2.707l3.146 3.147a.5.5 0 0 0 .708-.708l-4-4a.5.5 0 0 0-.708 0l-4 4a.5.5 0 1 0 .708.708L11 2.707V14.5a.5.5 0 0 0 .5.5zm-7-14a.5.5 0 0 1 .5.5v11.793l3.146-3.147a.5.5 0 0 1 .708.708l-4 4a.5.5 0 0 1-.708 0l-4-4a.5.5 0 0 1 .708-.708L4 13.293V1.5a.5.5 0 0 1 .5-.5z"/>
                  </svg>
            </th>
            <th>Industry</th>
        </thead>
        {% for business in businesses %}
            <tr>
                <td>{{business.business_name}}</td>
                <td>{{business.address}}</td>
                <td>{{business.state}}</td>
                <td>{{business.revenue_estimate | currency}}</td>
                <td>{{business.num_employees}}</td>
                <td>{{business.payroll_annual | currency}}</td>
                <!-- <td>{{business.naics_name}}</td> -->
                <td>
                    <a href="#">
                        {{business.naics_name}}
                    </a>
                </td>
            </tr>
        {% endfor %}
    </table>
    <div class="d-grid gap-2 d-md-flex justify-content-md-end">
        <button id = "prevButton" class="btn btn-primary me-md-2" type="button">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-left-square" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M15 2a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2zM0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2zm11.5 5.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H11.5z"/>
              </svg>
              Previous</button>
        <button id="nextButton" class="btn btn-primary" type="button">Next
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-right-square" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M15 2a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2zM0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2zm4.5 5.5a.5.5 0 0 0 0 1h5.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L10.293 7.5H4.5z"/>
              </svg>
        </button>
      </div>

</div>

    <script>
        var results_index = 0;
        $(document).ready(function(){
        $("#searchBusinessSubmit").click(function(){
            results_index = 0;
            searchBusinesses(results_index);
        });
        $("#resetSearchParameters").click(function(){
            $("#companyName").val("");
            $("#industry").val("");
            $("#zipCode").val("");
            $("#revenueRange").val("Any");
            $("#employeeRange").val("Any");
            $("#states").val("Any");
        });
        $("#nextButton").click(function(){
            results_index = results_index + 1;
            searchBusinesses(results_index);
        });
        $("#prevButton").click(function(){
            results_index = results_index - 1;
            searchBusinesses(results_index);
        });
        });

        function searchBusinesses(start_index){
            var s = '<div class="spinner-border text-primary" role="status" id="tableSpinner"> <span class="visually-hidden">Loading...</span></div>';
            $("#tableSpinner").html(s);
            $.ajax({
                url:"/lookup/search",
                type:"GET",
                data: {"companyName":$("#companyName").val(),
                    "zipCode":$('#zipCode').val(),
                    "industry":$('#industry').val(),
                        "revenueRange":$('#revenueRange option:selected').val(),
                    "employeeRange":$('#employeeRange option:selected').val(),
                    "state":$('#states option:selected').val(),
                "start_index":start_index},
            success: function(response){
                html = response["html"];            
                num_businesses = response["num_businesses"];
                $("#tableSpinner").html('');
                $("#resultBusinesses").html(html);
                $("#numBusinesses").html("Number of businesses matching applied filters: " + num_businesses);
            }})
        }

    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
</div>
  </body>
</html>